basePath: /api
definitions:
  exercise.CreateExerciseRequest:
    properties:
      name:
        type: string
    required:
    - name
    type: object
  exercise.CreateExerciseResponse:
    properties:
      created_at:
        example: "2023-01-01T15:04:05Z"
        type: string
      id:
        example: 1
        type: integer
      name:
        example: Bench Press
        type: string
      updated_at:
        example: "2023-01-01T15:04:05Z"
        type: string
      user_id:
        example: user-123
        type: string
    required:
    - created_at
    - id
    - name
    - updated_at
    - user_id
    type: object
  exercise.ExerciseDetailExerciseResponse:
    properties:
      best_e1rm:
        example: 305
        type: number
      created_at:
        example: "2023-01-01T15:04:05Z"
        type: string
      historical_1rm:
        example: 315
        type: number
      historical_1rm_source_workout_id:
        example: 42
        type: integer
      historical_1rm_updated_at:
        example: "2023-01-01T15:04:05Z"
        type: string
      id:
        example: 1
        type: integer
      name:
        example: Bench Press
        type: string
      updated_at:
        example: "2023-01-01T15:04:05Z"
        type: string
      user_id:
        example: user-123
        type: string
    required:
    - created_at
    - id
    - name
    - updated_at
    - user_id
    type: object
  exercise.ExerciseDetailResponse:
    properties:
      exercise:
        $ref: '#/definitions/exercise.ExerciseDetailExerciseResponse'
      sets:
        items:
          $ref: '#/definitions/exercise.ExerciseWithSetsResponse'
        type: array
    required:
    - exercise
    - sets
    type: object
  exercise.ExerciseMetricsHistoryPoint:
    properties:
      date:
        type: string
      session_avg_e1rm:
        type: number
      session_avg_intensity:
        type: number
      session_best_e1rm:
        type: number
      session_best_intensity:
        type: number
      total_volume_working:
        type: number
      workout_id:
        type: integer
      x:
        type: string
    type: object
  exercise.ExerciseMetricsHistoryResponse:
    properties:
      bucket:
        $ref: '#/definitions/exercise.MetricsHistoryBucket'
      points:
        items:
          $ref: '#/definitions/exercise.ExerciseMetricsHistoryPoint'
        type: array
      range:
        type: string
    type: object
  exercise.ExerciseResponse:
    properties:
      created_at:
        example: "2023-01-01T15:04:05Z"
        type: string
      id:
        example: 1
        type: integer
      name:
        example: Bench Press
        type: string
      updated_at:
        example: "2023-01-01T15:04:05Z"
        type: string
      user_id:
        example: user-123
        type: string
    required:
    - created_at
    - id
    - name
    - updated_at
    - user_id
    type: object
  exercise.ExerciseWithSetsResponse:
    properties:
      exercise_id:
        example: 1
        type: integer
      exercise_name:
        example: Bench Press
        type: string
      exercise_order:
        example: 0
        type: integer
      reps:
        example: 10
        type: integer
      set_id:
        example: 1
        type: integer
      set_order:
        example: 1
        type: integer
      set_type:
        example: working
        type: string
      volume:
        example: 2250.5
        type: number
      weight:
        example: 225.5
        type: number
      workout_date:
        example: "2023-01-01T15:04:05Z"
        type: string
      workout_id:
        example: 1
        type: integer
      workout_notes:
        example: Great workout today
        type: string
    required:
    - exercise_id
    - exercise_name
    - reps
    - set_id
    - set_type
    - volume
    - workout_date
    - workout_id
    type: object
  exercise.MetricsHistoryBucket:
    enum:
    - workout
    - week
    - month
    type: string
    x-enum-varnames:
    - MetricsHistoryBucketWorkout
    - MetricsHistoryBucketWeek
    - MetricsHistoryBucketMonth
  exercise.RecentSetsResponse:
    properties:
      created_at:
        example: "2023-01-01T15:04:05Z"
        type: string
      exercise_order:
        example: 0
        type: integer
      reps:
        example: 10
        type: integer
      set_id:
        example: 1
        type: integer
      set_order:
        example: 2
        type: integer
      weight:
        example: 225.5
        type: number
      workout_date:
        example: "2023-01-01T15:04:05Z"
        type: string
      workout_id:
        example: 1
        type: integer
    required:
    - created_at
    - reps
    - set_id
    - workout_date
    - workout_id
    type: object
  exercise.UpdateExerciseHistorical1RMRequest:
    properties:
      historical_1rm:
        maximum: 999999.99
        minimum: 0
        type: number
      mode:
        enum:
        - manual
        - recompute
        type: string
    type: object
  exercise.UpdateExerciseNameRequest:
    properties:
      name:
        maxLength: 256
        type: string
    required:
    - name
    type: object
  health.HealthResponse:
    properties:
      status:
        type: string
      timestamp:
        type: string
      version:
        type: string
    type: object
  health.ReadyResponse:
    properties:
      checks:
        additionalProperties:
          type: string
        type: object
      status:
        type: string
      timestamp:
        type: string
    type: object
  response.ErrorResponse:
    properties:
      message:
        example: Error message
        type: string
      request_id:
        example: 550e8400-e29b-41d4-a716-446655440000
        type: string
    type: object
  response.SuccessResponse:
    properties:
      success:
        example: true
        type: boolean
    type: object
  workout.ContributionDataResponse:
    properties:
      days:
        items:
          $ref: '#/definitions/workout.ContributionDay'
        type: array
    type: object
  workout.ContributionDay:
    properties:
      count:
        type: integer
      date:
        type: string
      level:
        type: integer
      workouts:
        items:
          $ref: '#/definitions/workout.WorkoutSummary'
        type: array
    type: object
  workout.CreateWorkoutRequest:
    properties:
      date:
        type: string
      exercises:
        items:
          $ref: '#/definitions/workout.ExerciseInput'
        minItems: 1
        type: array
      notes:
        maxLength: 256
        type: string
      workoutFocus:
        maxLength: 256
        type: string
    required:
    - date
    - exercises
    type: object
  workout.ExerciseInput:
    properties:
      name:
        maxLength: 256
        minLength: 1
        type: string
      sets:
        items:
          $ref: '#/definitions/workout.SetInput'
        minItems: 1
        type: array
    required:
    - name
    - sets
    type: object
  workout.SetInput:
    properties:
      reps:
        minimum: 1
        type: integer
      setType:
        enum:
        - warmup
        - working
        type: string
      weight:
        maximum: 9.999999999e+08
        minimum: 0
        type: number
    required:
    - reps
    - setType
    type: object
  workout.UpdateExercise:
    properties:
      name:
        maxLength: 256
        minLength: 1
        type: string
      sets:
        items:
          $ref: '#/definitions/workout.UpdateSet'
        minItems: 1
        type: array
    required:
    - name
    - sets
    type: object
  workout.UpdateSet:
    properties:
      reps:
        minimum: 1
        type: integer
      setType:
        enum:
        - warmup
        - working
        type: string
      weight:
        maximum: 9.999999999e+08
        minimum: 0
        type: number
    required:
    - reps
    - setType
    type: object
  workout.UpdateWorkoutRequest:
    properties:
      date:
        type: string
      exercises:
        items:
          $ref: '#/definitions/workout.UpdateExercise'
        minItems: 1
        type: array
      notes:
        maxLength: 256
        type: string
      workoutFocus:
        maxLength: 256
        type: string
    required:
    - date
    - exercises
    type: object
  workout.WorkoutResponse:
    description: Workout response model
    properties:
      created_at:
        example: "2023-01-01T15:04:05Z"
        type: string
      date:
        example: "2023-01-01T15:04:05Z"
        type: string
      id:
        example: 1
        type: integer
      notes:
        example: Great workout today
        type: string
      updated_at:
        example: "2023-01-01T15:04:05Z"
        type: string
      user_id:
        example: user-123
        type: string
      workout_focus:
        example: Upper Body
        type: string
    required:
    - created_at
    - date
    - id
    - updated_at
    - user_id
    type: object
  workout.WorkoutSummary:
    properties:
      focus:
        type: string
      id:
        type: integer
      time:
        type: string
    type: object
  workout.WorkoutWithSetsResponse:
    properties:
      exercise_id:
        example: 1
        type: integer
      exercise_name:
        example: Bench Press
        type: string
      exercise_order:
        example: 0
        type: integer
      reps:
        example: 10
        type: integer
      set_id:
        example: 1
        type: integer
      set_order:
        example: 1
        type: integer
      set_type:
        example: working
        type: string
      volume:
        example: 2250.5
        type: number
      weight:
        example: 225.5
        type: number
      workout_date:
        example: "2023-01-01T15:04:05Z"
        type: string
      workout_focus:
        example: Upper Body
        type: string
      workout_id:
        example: 1
        type: integer
      workout_notes:
        example: Great workout today
        type: string
    required:
    - exercise_id
    - exercise_name
    - reps
    - set_id
    - set_type
    - volume
    - workout_date
    - workout_id
    type: object
host: localhost:8080
info:
  contact:
    email: support@swagger.io
    name: API Support
    url: http://www.swagger.io/support
  description: A fitness tracking application API
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  termsOfService: http://swagger.io/terms/
  title: FitTrack API
  version: "1.0"
paths:
  /exercises:
    get:
      consumes:
      - application/json
      description: Get all exercises for the authenticated user
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/exercise.ExerciseResponse'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: List exercises
      tags:
      - exercises
    post:
      consumes:
      - application/json
      description: Get an existing exercise by name or create it if it doesn't exist
      parameters:
      - description: Exercise data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/exercise.CreateExerciseRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/exercise.CreateExerciseResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: Get or create exercise
      tags:
      - exercises
  /exercises/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a specific exercise and all its associated sets. Only the
        owner of the exercise can delete it.
      parameters:
      - description: Exercise ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "204":
          description: No Content - Exercise deleted successfully
        "400":
          description: Bad Request - Invalid exercise ID
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: Unauthorized - Invalid token
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found - Exercise not found or doesn't belong to user
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: Delete an exercise
      tags:
      - exercises
    get:
      consumes:
      - application/json
      description: Get a specific exercise (metadata) plus all its sets from workouts.
        Sets is empty when exercise exists but has no sets.
      parameters:
      - description: Exercise ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Success (sets may be empty)
          schema:
            $ref: '#/definitions/exercise.ExerciseDetailResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found - Exercise not found or doesn't belong to user
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: Get exercise with sets
      tags:
      - exercises
    patch:
      consumes:
      - application/json
      description: Update the name of an exercise by ID (must belong to authenticated
        user)
      parameters:
      - description: Exercise ID
        in: path
        name: id
        required: true
        type: integer
      - description: Exercise name update request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/exercise.UpdateExerciseNameRequest'
      produces:
      - application/json
      responses:
        "204":
          description: No Content - Exercise name updated successfully
        "400":
          description: Bad Request - Invalid exercise ID or validation error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: Unauthorized - Invalid token
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found - Exercise not found or doesn't belong to user
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "409":
          description: Conflict - Exercise name already exists
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: Update an exercise name
      tags:
      - exercises
  /exercises/{id}/historical-1rm:
    patch:
      consumes:
      - application/json
      description: Set a manual historical 1RM (clears source workout) or recompute
        from best working-set e1RM across history.
      parameters:
      - description: Exercise ID
        in: path
        name: id
        required: true
        type: integer
      - description: Historical 1RM update request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/exercise.UpdateExerciseHistorical1RMRequest'
      produces:
      - application/json
      responses:
        "204":
          description: No Content - Exercise historical 1RM updated successfully
        "400":
          description: Bad Request - Invalid exercise ID or validation error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: Unauthorized - Invalid token
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found - Exercise not found or doesn't belong to user
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: Update exercise historical 1RM
      tags:
      - exercises
  /exercises/{id}/metrics-history:
    get:
      consumes:
      - application/json
      description: 'Get time-series session metrics for an exercise. Range controls
        bucketing: W/M return per-workout points; 6M weekly buckets; Y monthly buckets.'
      parameters:
      - description: Exercise ID
        in: path
        name: id
        required: true
        type: integer
      - default: M
        description: Range selector
        enum:
        - W
        - M
        - 6M
        - "Y"
        in: query
        name: range
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/exercise.ExerciseMetricsHistoryResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found - Exercise not found or doesn't belong to user
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: Get exercise metrics history
      tags:
      - exercises
  /exercises/{id}/recent-sets:
    get:
      consumes:
      - application/json
      description: Get the 3 most recent sets for a specific exercise. Returns empty
        array when exercise has no sets.
      parameters:
      - description: Exercise ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Success (may be empty array)
          schema:
            items:
              $ref: '#/definitions/exercise.RecentSetsResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: Get recent sets for exercise
      tags:
      - exercises
  /health:
    get:
      description: Returns the health status of the API
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/health.HealthResponse'
      summary: Health check
      tags:
      - health
  /ready:
    get:
      description: Returns the readiness status of the API including database connectivity
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/health.ReadyResponse'
        "503":
          description: Service Unavailable
          schema:
            $ref: '#/definitions/health.ReadyResponse'
      summary: Readiness check
      tags:
      - health
  /workouts:
    get:
      consumes:
      - application/json
      description: Get all workouts for the authenticated user
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/workout.WorkoutResponse'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: List workouts
      tags:
      - workouts
    post:
      consumes:
      - application/json
      description: Create a new workout with exercises and sets
      parameters:
      - description: Workout data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/workout.CreateWorkoutRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/response.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: Create a new workout
      tags:
      - workouts
  /workouts/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a specific workout and all its associated sets. Only the
        owner of the workout can delete it.
      parameters:
      - description: Workout ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "204":
          description: No Content - Workout deleted successfully
        "400":
          description: Bad Request - Invalid workout ID
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: Unauthorized - Invalid token
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found - Workout not found or doesn't belong to user
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: Delete a workout
      tags:
      - workouts
    get:
      consumes:
      - application/json
      description: Get a specific workout with all its sets and exercises
      parameters:
      - description: Workout ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/workout.WorkoutWithSetsResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: Get workout with sets
      tags:
      - workouts
    put:
      consumes:
      - application/json
      description: Updates a workout using full replacement semantics. The client
        must provide the complete workout data including date and at least one exercise
        with sets. This endpoint replaces the entire workout, deleting existing exercises/sets
        and creating new ones. For partial updates, PATCH will be implemented in a
        future version. Returns 204 No Content on success.
      parameters:
      - description: Workout ID
        in: path
        name: id
        required: true
        type: integer
      - description: Complete workout data for replacement
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/workout.UpdateWorkoutRequest'
      produces:
      - application/json
      responses:
        "204":
          description: No Content - Workout updated successfully
        "400":
          description: Bad Request - Invalid input or validation error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "401":
          description: Unauthorized - Invalid token
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "404":
          description: Not Found - Workout not found or doesn't belong to user
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: Update an existing workout (full replacement)
      tags:
      - workouts
  /workouts/contribution-data:
    get:
      consumes:
      - application/json
      description: Get workout contribution data for the past 52 weeks, including
        daily working set counts and intensity levels (0-4) for visualization in a
        contribution graph
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/workout.ContributionDataResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: Get contribution graph data
      tags:
      - workouts
  /workouts/focus-values:
    get:
      consumes:
      - application/json
      description: Get all distinct workout focus values for the authenticated user.
        Returns 200 OK with an empty array if no workout focus values exist.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              type: string
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/response.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/response.ErrorResponse'
      security:
      - StackAuth: []
      summary: List workout focus values
      tags:
      - workouts
schemes:
- http
securityDefinitions:
  StackAuth:
    in: header
    name: x-stack-access-token
    type: apiKey
swagger: "2.0"
